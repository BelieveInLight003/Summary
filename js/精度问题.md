### 0.1 + 0.2 === 0.3 // false

###### 二进制存储

```
// 0.1 和 0.2 都转化成二进制后再进行运算
0.00011001100110011001100110011001100110011001100110011010 +
0.0011001100110011001100110011001100110011001100110011010 =
0.0100110011001100110011001100110011001100110011001100111

// 转成十进制正好是 0.30000000000000004
```

###### 解决方案

- toPrecision() 是 JavaScript 中 Number 类型的一个方法，用于将数字转换为指定有效数字位数的字符串表示。
- 封装方法

```
 function strip(num, precision = 12) {
   return +parseFloat(num.toPrecision(precision));
 }
```

###### 第三方库解决

- Math.js

```
// 原生 JS 大整数精度丢失
console.log(9007199254740993 === 9007199254740992); // true（错误）

// Math.js 精确处理大整数
console.log(math.equal(math.bignumber('9007199254740993'), math.bignumber('9007199254740992'))); // false（正确）
```

- BigDecimal.js

```
// 首先需要安装 bigdecimal.js
// npm install bigdecimal

const { BigDecimal, MathContext } = require('bigdecimal.js');

// 使用字符串创建 BigDecimal 实例（关键：避免使用数字直接量，防止初始精度丢失）
const a = new BigDecimal('0.1');
const b = new BigDecimal('0.2');

// 进行加法运算
const sum = a.add(b);

// 输出结果
console.log(sum.toString()); // 输出 "0.3"（正确结果）

// 对比原生 JavaScript 计算
console.log(0.1 + 0.2); // 输出 0.30000000000000004（精度问题）

// 更复杂的运算示例
const c = new BigDecimal('1.0');
const d = new BigDecimal('0.9');
const difference = c.subtract(d);
console.log(difference.toString()); // 输出 "0.1"（正确结果）

// 可以设置精度上下文（可选）
const mc = new MathContext(20); // 20位精度
const e = new BigDecimal('1', mc);
const f = new BigDecimal('3', mc);
const division = e.divide(f); // 1/3
console.log(division.toString()); // 输出 "0.33333333333333333333"

```
